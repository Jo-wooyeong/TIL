## 서브쿼리(Inline View)
```
서브쿼리(Subquery)란 하나의 SQL 문 안에 포함되어 있는 또 다른 SQL 문을 말합니다. 주로 괄호 `()`로 감싸져 있으며, 메인 쿼리(Main Query)가 실행되기 전에 한 번 실행되어 그 결과를 메인 쿼리에 제공한다.
서브쿼리를 이용하면 데이터를 미리 필터링해서 가져오는 방식이라 성능면에서 이점이 있다.
```

**사용 이유:**
1. **복잡한 단계의 단순화:** 여러 번의 쿼리를 실행해야 얻을 수 있는 결과를 하나의 쿼리로 해결할 수 있습니다.
2. **동적인 데이터 필터링:** 사전에 값을 알 수 없는 경우, 다른 테이블이나 집계 결과를 조건으로 사용하여 데이터를 조회할 때 유용합니다.
3. **구조화된 쿼리 작성:** 복잡한 조인(Join) 로직을 가독성 있게 분리하거나, 임시 테이블처럼 활용(Inline View)할 수 있습니다.

예시)
```sql
SELECT REST_SEOUL.REST_ID,
    REST_SEOUL.REST_NAME,
    REST_SEOUL.FOOD_TYPE,
    REST_SEOUL.FAVORITES,
    REST_SEOUL.ADDRESS,
    ROUND(AVG(REVIEW_SCORE), 2) AS SCORE
    
FROM (
    SELECT REST_ID, REST_NAME, FOOD_TYPE, FAVORITES, ADDRESS
    FROM REST_INFO
    WHERE ADDRESS LIKE '서울%'
) AS REST_SEOUL
JOIN REST_REVIEW AS REVIEW
    ON REST_SEOUL.REST_ID = REVIEW.REST_ID

GROUP BY REST_SEOUL.REST_ID
ORDER BY SCORE DESC, REST_SEOUL.FAVORITES DESC;
```

### 서브쿼리 실행
쿼리문에서 가장 먼저 서브쿼리가 실행됨. 주소가 서울로 시작되는 식당만 골라내고 식당 전체 데이터가 아니라 필요한 데이터만 가져옵니다.
```
FROM (
    SELECT REST_ID, REST_NAME, FOOD_TYPE, FAVORITES, ADDRESS
    FROM REST_INFO
    WHERE ADDRESS LIKE '서울%'
) AS REST_SEOUL
```

#### 수평적 필터링
`WHERE ADDRESS LIKE '서울%'`: 행(Row)의 개수를 줄이는 작업
- JOIN의 연상량을 줄인다.

#### 수직적 필터링
`SELECT ID, NAME, ...`: 열(Column)의 너비를 줄이는 작업
- 필요한 컬럼만 명시하면 메모리 점유율을 낮출 수 있다.

### `WHERE`절 서브쿼리
**예시:**
```sql
SELECT 
    B.TITLE, 
    B.BOARD_ID, 
    R.REPLY_ID, 
    R.WRITER_ID, 
    R.CONTENTS, 
    DATE_FORMAT(R.CREATED_DATE, '%Y-%m-%d') AS CREATED_DATE 
FROM ( 
    SELECT BOARD_ID, TITLE 
    FROM USED_GOODS_BOARD 
    WHERE CREATED_DATE >= '2022-10-01' AND CREATED_DATE < '2022-11-01' 
) AS B 
INNER JOIN USED_GOODS_REPLY AS R 
    ON B.BOARD_ID = R.BOARD_ID 
ORDER BY R.CREATED_DATE ASC, B.TITLE ASC;
```